<div class="card p-3">
  <h3>All Certificates</h3>
  <div *ngIf="loading" class="alert alert-info">Loading certificates...</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
  <table *ngIf="!loading && certificates.length" class="table table-bordered table-hover">
    <thead>
      <tr>
        <th>Serial Number</th>
        <th>Type</th>
        <th>Issued</th>
        <th>Expires</th>
        <th>Signature Algorithm</th>
        <th>Subject CN</th>
        <th>Subject O</th>
        <th>Subject OU</th>
        <th>Issuer CN</th>
        <th>Issuer O</th>
        <th>Issuer OU</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let cert of certificates">
        <td>{{ cert.serialNumber }}</td>
        <td>{{ cert.type }}</td>
        <td>{{ cert.issued | date:'yyyy-MM-dd' }}</td>
        <td>{{ cert.expires | date:'yyyy-MM-dd' }}</td>
        <td>{{ cert.signatureAlgorithm }}</td>
        <td>{{ cert.subjectCN }}</td>
        <td>{{ cert.subjectO }}</td>
        <td>{{ cert.subjectOU }}</td>
        <td>{{ cert.issuerCN }}</td>
        <td>{{ cert.issuerO }}</td>
        <td>{{ cert.issuerOU }}</td>
      </tr>
    </tbody>
  </table>
  <div *ngIf="!loading && !certificates.length" class="alert alert-warning">No certificates found.</div>
  <div class="my-3 d-flex align-items-center gap-2" *ngIf="certificates.length">
    <label for="certSelect" class="form-label mb-0">Certificate:</label>
    <select id="certSelect" class="form-select form-select-sm w-auto" [(ngModel)]="selectedSerial">
      <option *ngFor="let cert of certificates" [value]="cert.serialNumber">{{ cert.serialNumber }}</option>
    </select>
    <label for="reasonSelect" class="form-label mb-0">Reason:</label>
    <select id="reasonSelect" class="form-select form-select-sm w-auto" [(ngModel)]="selectedReason">
      <option *ngFor="let reason of revocationReasons" [value]="reason.value">{{ reason.label }}</option>
    </select>
    <button class="btn btn-danger btn-sm" (click)="revokeSelectedCertificate()" [disabled]="!selectedSerial">Revoke</button>
  </div>
</div>
